(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72ef5618"],{"11b7":function(e,t,r){"use strict";var a=r("c6ea"),n=r.n(a);n.a},7335:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"admin-update"},[r("div",{staticClass:"form-wrapper"},[r("h1",[e._v("Update Book")]),r("form",{staticClass:"edit-form",attrs:{action:"",enctype:"multipart/form-data"},on:{submit:function(t){return t.preventDefault(),e.sendForm()}}},[r("div",{staticClass:"form-name"},[r("label",{attrs:{for:"name"}},[e._v("Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],attrs:{type:"text",name:"name",id:"name"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}})]),r("div",{staticClass:"form-genre"},[r("label",{attrs:{for:"author"}},[e._v("Author")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.author_id,expression:"form.author_id"}],attrs:{name:"author",id:"genre"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"author_id",t.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"null"}},[e._v("Select Author")]),e._l(e.allAuthor,(function(t,a){return r("option",{key:a,domProps:{value:t._id,selected:t.name==e.book.author||null}},[e._v(e._s(t.name))])}))],2)]),r("div",{staticClass:"form-genre"},[r("label",{attrs:{for:"genre"}},[e._v("Genre")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.genre,expression:"form.genre"}],attrs:{name:"genre",id:"genre"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"genre",t.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"null"}},[e._v("Select Genre")]),e._l(e.allGenre,(function(t,a){return r("option",{key:a},[e._v(e._s(t.name))])}))],2)]),r("div",{staticClass:"form-image"},[r("label",{attrs:{for:"image"}},[e._v("Image")]),r("input",{ref:"image",attrs:{type:"file",name:"image",id:"image"},on:{change:e.handleUpload}})]),r("img",{attrs:{src:e.setImage,id:"image-view",alt:""}}),r("p",{staticClass:"btn btn-danger btn-delete w-25",on:{click:e.deleteImg}},[e._v("Delete")]),r("div",{staticClass:"form-description"},[r("label",{attrs:{for:"description"}},[e._v("Description")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.description,expression:"form.description"}],attrs:{name:"description",id:"description",cols:"30",rows:"10"},domProps:{value:e.form.description},on:{input:function(t){t.target.composing||e.$set(e.form,"description",t.target.value)}}})]),e.error.length>0?r("div",{staticClass:"error-wrapper"},[r("ul",{staticClass:"list-error"},e._l(e.error,(function(t,a){return r("li",{key:a},[e._v(" "+e._s(t)+" ")])})),0)]):e._e(),r("input",{staticClass:"btn btn-primary btn-submit",attrs:{type:"submit",value:"Change Data"}})])])])},n=[],o=(r("a4d3"),r("e01a"),r("d81d"),r("b0c0"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("5530")),i=(r("96cf"),r("1da1")),s=r("ed08"),u={name:"adminBookEdit",data:function(){return{allGenre:[],allAuthor:[],book:[],form:{name:"",genre:null,photo:null,author_id:null,description:""},imgDefault:!1,error:[],limit:5,key:this.$route.params.key||" ",page:this.$route.params.page}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.$route.params.bookId,t.next=4,Object(s["o"])(r);case 4:return a=t.sent,e.book=a,e.setForm(e.book),t.next=9,Object(s["j"])();case 9:return e.allGenre=t.sent,t.next=12,Object(s["h"])();case 12:e.allAuthor=t.sent,t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),e.$router.push({name:"admin-book",params:{status:"error"}});case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))()},methods:{sendForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.validateForm(e.form),!(r.length>0)){t.next=3;break}return t.abrupt("return",e.error=r.map((function(e){return e.msg})));case 3:return t.prev=3,a=e.$route.params.bookId,n=Object(o["a"])(Object(o["a"])({},e.form),{},{bookId:a,imgDefault:e.imgDefault}),t.next=8,Object(s["t"])(n,e.page,e.limit,e.$route.query);case 8:return t.next=10,e.$router.push({name:"admin-book-status",params:{status:"success"},query:{page:e.page}});case 10:t.next=17;break;case 12:return t.prev=12,t.t0=t["catch"](3),console.log(t.t0),t.next=17,e.$router.push({name:"admin-book-status",params:{status:"error"}});case 17:case"end":return t.stop()}}),t,null,[[3,12]])})))()},handleUpload:function(){var e=this.$refs.image.files[0];this.form.photo=e;var t=document.getElementById("image-view");t.src=URL.createObjectURL(e),window.onload=function(){URL.revokeObjectURL(t.src)}},deleteImg:function(){var e=document.getElementById("image-view");e.src=null,this.form.photo=null},setForm:function(e){var t=e.name,r=e.author,a=e.genre,n=e.description;this.form={name:t,author_id:r?r._id:"",genre:a||"",description:n}},validateForm:function(e){var t=[],r=document.getElementById("image-view");return e.name&&""!=e.name||t.push({msg:"Name is required "}),e.author_id&&"null"!=e.author_id||t.push({msg:"Author is required "}),e.genre&&"null"!=e.genre||t.push({msg:"Genre is required "}),e.description&&"null"!=e.description||t.push({msg:"Description is required "}),e.photo&&e.photo.size/1e3>2e3&&t.push({msg:"Your file is too large"}),encodeURI(this.setImage)==r.src&&(this.imgDefault=!0),t}},computed:{setImage:function(){var e=Object(o["a"])({},this.book.photo);return e.filename?"http://localhost:5000/img-card/".concat(this.book.photo.filename):null}}},l=u,m=(r("11b7"),r("2877")),c=Object(m["a"])(l,a,n,!1,null,"ebdedf5a",null);t["default"]=c.exports},c6ea:function(e,t,r){},d81d:function(e,t,r){"use strict";var a=r("23e7"),n=r("b727").map,o=r("1dde"),i=r("ae40"),s=o("map"),u=i("map");a({target:"Array",proto:!0,forced:!s||!u},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-72ef5618.9bebcc42.js.map